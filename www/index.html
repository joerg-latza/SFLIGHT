<!DOCTYPE HTML>
<html>
    <head>
        <title>Employee Directory</title>
        <meta name="viewport" content="width=device-width,initial-scale=1"/>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>    
    </head>
    <body>
        <div id="flightListPage" data-role="page">
            <div data-role="header" data-position="fixed">
                <h1>SFLIGHT</h1>
            </div>
            <div data-role="content">
                <ul id="flightList" data-role="listview" data-filter="true"></ul>
            </div>
        </div>
        <script>
            
            var flightList = function (data) {
                $('#flightList li').remove();
        		$.each(data, function(index, flight) {
        			$('#flightList').append(
                        '<li>' +
                            '<a href="#">' +
        				        '<h4>' + flight.NAME + '</h4>' +
        				        '<p>' + flight.STREET + '</p>' +
        				    '</a>' + 
                        '</li>');
        		});
        		$('#flightList').listview('refresh');
            }
            
            $('#flightListPage').bind('pageinit', function(event) {
                
                $.ajax({
                    url: "http://pub2-174.env.cloudshare.com:8000/sflight/sflight/api/agencies",
                    dataType: "jsonp",
                    success: function(data) {
                        flightList(data)
                    },
                    error: function(data) {
                        flightList({items: [{NAME: "Agency AAA", STREET: "Street"}, {NAME: "Agency AAA", STREET: "Street"}]});
                    }
                });  

            });
            
        </script>
    </body>
</html>