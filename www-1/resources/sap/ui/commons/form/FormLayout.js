/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.commons.form.FormLayout");jQuery.sap.require("sap.ui.commons.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.ui.commons.form.FormLayout",{metadata:{library:"sap.ui.commons"}});jQuery.sap.require("sap.ui.commons.form.Form");(function(){sap.ui.commons.form.FormLayout.prototype.contentOnAfterRendering=function(f,c){jQuery(c.getFocusDomRef()).data("sap.InNavArea",true)};sap.ui.commons.form.FormLayout.prototype.toggleContainerExpanded=function(c){var e=c.getExpanded();if(this.getDomRef()){if(e){jQuery.sap.byId(c.getId()+"-content").css("display","")}else{jQuery.sap.byId(c.getId()+"-content").css("display","none")}}};sap.ui.commons.form.FormLayout.prototype.onsapright=function(e){var r=sap.ui.getCore().getConfiguration().getRTL();var t=this;if(!r){this.navigateForward(e,t)}else{this.navigateBack(e,t)}};sap.ui.commons.form.FormLayout.prototype.onsapleft=function(e){var r=sap.ui.getCore().getConfiguration().getRTL();var t=this;if(!r){this.navigateBack(e,t)}else{this.navigateForward(e,t)}};sap.ui.commons.form.FormLayout.prototype.onsapdown=function(e){var c=e.srcControl;var C=0;var n;var r=this.findElement(c);var E=r.element;c=r.rootControl;if(E&&E instanceof sap.ui.commons.form.FormElement){n=this.findFieldBelow(c,E)}else if(E&&E instanceof sap.ui.commons.form.FormContainer){n=this.findFirstFieldOfNextElement(E,0)}if(n){jQuery.sap.focus(n);e.preventDefault()}};sap.ui.commons.form.FormLayout.prototype.onsapup=function(e){var c=e.srcControl;var C=0;var n;var r=this.findElement(c);var E=r.element;c=r.rootControl;if(E&&E instanceof sap.ui.commons.form.FormElement){n=this.findFieldAbove(c,E)}else if(E&&E instanceof sap.ui.commons.form.FormContainer){var f=E.getParent();C=f.indexOfFormContainer(E);n=this.findLastFieldOfLastElementInPrevContainer(f,C-1)}if(n){jQuery.sap.focus(n);e.preventDefault()}};sap.ui.commons.form.FormLayout.prototype.onkeydown=function(e){if(e.keyCode==jQuery.sap.KeyCodes.F6){var c=e.srcControl;var r=this.findElement(c);var E=r.element;c=r.rootControl;var n;var C;if(E&&E instanceof sap.ui.commons.form.FormElement){C=E.getParent()}else if(E&&E instanceof sap.ui.commons.form.FormContainer){C=E}var f=C.getParent();var i=f.indexOfFormContainer(C);if(!e.shiftKey){n=this.findFirstFieldOfFirstElementInNextContainer(f,i+1)}else{n=this.findLastFieldOfLastElementInPrevContainer(f,i-1)}if(n){jQuery.sap.focus(n);e.preventDefault()}}};sap.ui.commons.form.FormLayout.prototype.findElement=function(c){var e=c.getParent();var r=c;while(e&&!(e instanceof sap.ui.commons.form.FormElement)&&!(e&&e instanceof sap.ui.commons.form.FormContainer)&&!(e&&e instanceof sap.ui.commons.form.Form)){r=e;e=e.getParent()}return({rootControl:r,element:e})};sap.ui.commons.form.FormLayout.prototype.navigateForward=function(e){var c=e.srcControl;var C=0;var n;var r=this.findElement(c);var E=r.element;c=r.rootControl;if(E&&E instanceof sap.ui.commons.form.FormElement){if(c==E.getLabelControl()){C=-1}else{C=E.indexOfField(c)}n=this.findNextFieldOfElement(E,C+1);if(!n){var o=E.getParent();C=o.indexOfFormElement(E);n=this.findFirstFieldOfNextElement(o,C+1);if(!n){var f=o.getParent();C=f.indexOfFormContainer(o);n=this.findFirstFieldOfFirstElementInNextContainer(f,C+1)}}}else if(E&&E instanceof sap.ui.commons.form.FormContainer){n=this.findFirstFieldOfNextElement(E,0)}if(n){jQuery.sap.focus(n);e.preventDefault()}};sap.ui.commons.form.FormLayout.prototype.findNextFieldOfElement=function(e,s){var f=e.getFields();var l=f.length;var n;for(var i=s;i<l;i++){var F=f[i];var d=F.getFocusDomRef();if((!F.getEnabled||F.getEnabled())&&d){n=d;break}}return n};sap.ui.commons.form.FormLayout.prototype.findFirstFieldOfNextElement=function(c,s){var e=c.getFormElements();var l=e.length;var n;var i=s;while(!n&&i<l){var E=e[i];n=this.findNextFieldOfElement(E,0);i++}return n};sap.ui.commons.form.FormLayout.prototype.findFirstFieldOfFirstElementInNextContainer=function(f,s){var c=f.getFormContainers();var l=c.length;var n;var i=s;while(!n&&i<l){var C=c[i];if(!C.getExpandable()||C.getExpanded()){n=this.findFirstFieldOfNextElement(C,0)}i++}return n};sap.ui.commons.form.FormLayout.prototype.navigateBack=function(e){var c=e.srcControl;var C=0;var n;var r=this.findElement(c);var E=r.element;c=r.rootControl;if(E&&E instanceof sap.ui.commons.form.FormElement){if(c==E.getLabelControl()){C=0}else{C=E.indexOfField(c)}n=this.findPrevFieldOfElement(E,C-1);if(!n){var o=E.getParent();C=o.indexOfFormElement(E);n=this.findLastFieldOfPrevElement(o,C-1);if(!n){var f=o.getParent();C=f.indexOfFormContainer(o);n=this.findLastFieldOfLastElementInPrevContainer(f,C-1)}}}else if(E&&E instanceof sap.ui.commons.form.FormContainer){var f=E.getParent();C=f.indexOfFormContainer(E);n=this.findLastFieldOfLastElementInPrevContainer(f,C-1)}if(n){jQuery.sap.focus(n);e.preventDefault()}};sap.ui.commons.form.FormLayout.prototype.findPrevFieldOfElement=function(e,s){var f=e.getFields();var n;for(var i=s;i>=0;i--){var F=f[i];var d=F.getFocusDomRef();if((!F.getEnabled||F.getEnabled())&&d){n=d;break}}return n};sap.ui.commons.form.FormLayout.prototype.findLastFieldOfPrevElement=function(c,s){var e=c.getFormElements();var n;var i=s;while(!n&&i>=0){var E=e[i];var l=E.getFields().length;n=this.findPrevFieldOfElement(E,l-1);i--}return n};sap.ui.commons.form.FormLayout.prototype.findLastFieldOfLastElementInPrevContainer=function(f,s){var c=f.getFormContainers();var n;var i=s;while(!n&&i>=0){var C=c[i];if(!C.getExpandable()||C.getExpanded()){var l=C.getFormElements().length;n=this.findLastFieldOfPrevElement(C,l-1)}i--}return n};sap.ui.commons.form.FormLayout.prototype.findFieldBelow=function(c,e){var C=e.getParent();var i=C.indexOfFormElement(e);var n=this.findFirstFieldOfNextElement(C,i+1);if(!n){var f=C.getParent();i=f.indexOfFormContainer(C);n=this.findFirstFieldOfFirstElementInNextContainer(f,i+1)}return n};sap.ui.commons.form.FormLayout.prototype.findFieldAbove=function(c,e){var C=e.getParent();var a=C.indexOfFormElement(e);var E=C.getFormElements();var n;var i=a-1;while(!n&&i>=0){var e=E[i];n=this.findPrevFieldOfElement(e,0);i--}if(!n){var f=C.getParent();a=f.indexOfFormContainer(C);n=this.findLastFieldOfLastElementInPrevContainer(f,a-1)}return n}}());
