/*!
 * jQuery MobiScroll v2.2
 * http://mobiscroll.com
 *
 * Copyright 2010-2011, Acid Media
 * Licensed under the MIT license.
 *
 */
(function($){var a={inputClass:'',invalid:[],rtl:false,group:false,groupLabel:'Groups'};$.mobiscroll.presets.select=function(b){var s=$.extend({},a,b.settings),c=$(this),o=c.val(),g=c.find('option[value="'+c.val()+'"]').parent(),p=g.index()+'',f=p,h,j=this.id+'_dummy',l=$('label[for="'+this.id+'"]').attr('for',j),k=$('label[for="'+j+'"]'),m=s.label!==undefined?s.label:(k.length?k.text():c.attr('name')),n=[],q={},r={},t,u=b.settings.readonly,w;function x(d){if(d){return d.replace(/_/,'')}return''}function y(){var d,e=0,i={},w=[{}];if(s.group){if(s.rtl){e=1}$('optgroup',c).each(function(v){i['_'+v]=$(this).attr('label')});w[e]={};w[e][s.groupLabel]=i;d=g;e+=(s.rtl?-1:1)}else{d=c}w[e]={};w[e][m]={};$('option',d).each(function(){var v=$(this).attr('value');w[e][m]['_'+v]=$(this).text();if($(this).prop('disabled')){n.push(v)}});return w}if(s.group&&!$('optgroup',c).length){s.group=false}if(!s.invalid.length){s.invalid=n}if(s.group){if(s.rtl){r.groups=1;r.options=0}else{r.groups=0;r.options=1}}else{r.groups=-1;r.options=0}$('#'+j).remove();$('option',c).each(function(){q[$(this).attr('value')]=$(this).text()});var z=$('<input type="text" id="'+j+'" value="'+q[c.val()]+'" class="'+s.inputClass+'" readonly />').insertBefore(c);b.settings.anchor=z;if(s.showOnFocus){z.focus(function(){b.show()})}c.bind('change',function(){if(!h&&o!=c.val()){b.setSelectVal([c.val()],true)}h=false}).hide().closest('.ui-field-contain').trigger('create');b.setSelectVal=function(d,e,i){o=d[0];if(s.group){g=c.find('option[value="'+o+'"]').parent();f=g.index();b.temp=s.rtl?['_'+o,'_'+g.index()]:['_'+g.index(),'_'+o];if(f!==p){b.settings.wheels=y();b.changeWheel(r.options);p=f+''}}else{b.temp=['_'+o]}b.setValue(true,e,i);if(e){z.val(q[o]);var v=o!==c.val();c.val(o);if(v){c.trigger('change')}}};b.getSelectVal=function(d){var v=d?b.temp:b.values;return x(v[r.options])};return{width:50,wheels:w,headerText:false,formatResult:function(d){return q[o]},parseValue:function(){o=c.val();g=c.find('option[value="'+o+'"]').parent();f=g.index();return s.group&&s.rtl?['_'+o,'_'+f]:s.group?['_'+f,'_'+o]:['_'+o]},validate:function(d,e,A){if(e===r.groups){f=x(b.temp[r.groups]);if(f!==p){b.settings.readonly=[s.rtl,!s.rtl];g=c.find('optgroup').eq(f);f=g.index();o=g.find('option').eq(0).val();o=o||c.val();clearTimeout(t);t=setTimeout(function(){b.settings.wheels=y();if(s.group){b.temp=s.rtl?['_'+o,'_'+g.index()]:['_'+g.index(),'_'+o];b.changeWheel(r.options);p=f+''}b.settings.readonly=u},A*1000)}else{b.settings.readonly=u}}else{o=x(b.temp[r.options])}$.each(s.invalid,function(i,v){$('li[data-val="_'+v+'"]',d).removeClass('dw-v')})},onShow:function(d){$('.dwwl'+r.groups,d).bind('mousedown touchstart',function(e){clearTimeout(t)})},onBeforeShow:function(){b.settings.wheels=y();if(s.group){b.temp=s.rtl?['_'+o,'_'+g.index()]:['_'+g.index(),'_'+o]}},onSelect:function(v,b){z.val(v);h=true;c.val(o).trigger('change');if(s.group){b.values=null}},onCancel:function(){if(s.group){b.values=null}},onChange:function(v,b){if(s.display=='inline'){z.val(v);h=true;c.val(x(b.temp[r.options])).trigger('change')}},onClose:function(){z.blur()},methods:{setValue:function(d,e,i){return this.each(function(){var b=$(this).mobiscroll('getInst');if(b){if(b.setSelectVal){b.setSelectVal(d,e,i)}else{b.temp=d;b.setValue(true,e,i)}}})},getValue:function(d){var b=$(this).mobiscroll('getInst');if(b){if(b.getSelectVal){return b.getSelectVal(d)}return b.values}}}}}})(jQuery);
