/*!
 * jQuery MobiScroll v2.2
 * http://mobiscroll.com
 *
 * Copyright 2010-2011, Acid Media
 * Licensed under the MIT license.
 *
 */
(function($){var d={invalid:[],showInput:true,inputClass:''};$.mobiscroll.presets.list=function(b){var s=$.extend({},d,b.settings),f=$(this),g,h,k=this.id+'_dummy',m=0,p=0,q=s.wheelArray||I(f),r=B(m),u=[],x=G(q),w=C(x,m);function y(a,n,c,e){var i=0;while(i<n){var j=$('.dwwl'+i,a),l=z(e,i,c);$.each(l,function(i,v){$('li[data-val="'+v+'"]',j).removeClass('dw-v')});i++}}function z(a,c,e){var i=0,j=e,l=[];while(i<c){var o=a[i];for(var n in j){if(j[n].key==o){j=j[n].children;break}}i++}i=0;while(i<j.length){if(j[i].invalid){l.push(j[i].key)}i++}return l}function A(n,i){var a=[];while(n){a[--n]=true}a[i]=false;return a}function B(l){var a=[],i;for(i=0;i<l;i++){a[i]=s.labels&&s.labels[i]?s.labels[i]:i}return a}function C(a,l,c){var i=0,j,o,e,w=[{}],n=q;if(l){for(j=0;j<l;j++){w[j]={};w[j][r[j]]={}}}while(i<a.length){w[i]={};w[i][r[i]]=E(n);j=0;e=undefined;while(j<n.length&&e===undefined){if(n[j].key==a[i]&&((c!==undefined&&i<=c)||c===undefined)){e=j}j++}if(e!==undefined&&n[e].children){i++;n=n[e].children}else if((o=D(n))&&o.children){i++;n=o.children}else{return w}}return w}function D(a,c){if(!a){return false}var i=0,o;while(i<a.length){if(!(o=a[i++]).invalid){return c?i-1:o}}return false}function E(o){var a={},j=0;while(j<o.length){a[o[j].key]=o[j++].value}return a}function F(a,i){$('.dwc',a).css('display','').slice(i).hide()}function G(q){var t=[],n=q,o,a=true,i=0;while(a){o=D(n);t[i++]=o.key;if(a=o.children){n=o.children}}return t}function H(a,c){var t=[],n=q,m=0,e=false,i,j,l;if(a[m]!==undefined&&m<=c){i=0;j=a[m];l=undefined;while(i<n.length&&l===undefined){if(n[i].key==a[m]&&!n[i].invalid){l=i}i++}}else{l=D(n,true);j=n[l].key}e=l!==undefined?n[l].children:false;t[m]=j;while(e){n=n[l].children;m++;e=false;l=undefined;if(a[m]!==undefined&&m<=c){i=0;j=a[m];l=undefined;while(i<n.length&&l===undefined){if(n[i].key==a[m]&&!n[i].invalid){l=i}i++}}else{l=D(n,true);l=l===false?undefined:l;j=n[l].key}e=l!==undefined&&D(n[l].children)?n[l].children:false;t[m]=j}return{lvl:m+1,nVector:t}}function I(a){var e=[];m=m>p++?m:p;a.children('li').each(function(i){var t=$(this),c=t.clone();c.children('ul,ol').remove();var v=c.html().replace(/^\s\s*/,'').replace(/\s\s*$/,''),j=t.data('invalid')?true:false,l={key:t.data('val')||i,value:v,invalid:j,children:null},n=t.children('ul,ol');if(n.length){l.children=I(n)}e.push(l)});p--;return e}$('#'+k).remove();if(s.showInput){h=$('<input type="text" id="'+k+'" value="" class="'+s.inputClass+'" readonly />').insertBefore(f);b.settings.anchor=h;if(s.showOnFocus){h.focus(function(){b.show()})}}if(!s.wheelArray){f.hide().closest('.ui-field-contain').trigger('create')}return{width:50,wheels:w,headerText:false,onBeforeShow:function(a){var t=b.temp;u=b.temp.slice(0);b.settings.wheels=C(t,m,m)},onSelect:function(v,b){if(h){h.val(v)}},onChange:function(v,b){if(h&&s.display=='inline'){h.val(v)}},onClose:function(){if(h){h.blur()}},validate:function(a,c,j){var t=b.temp;if(c!==undefined&&u[c]!=t[c]){b.settings.readonly=A(m,c);$('.dwwl'+c,a).bind('mousedown touchstart',function(e){clearTimeout(g);b.settings.readonly=false;$(this).unbind('mousedown touchstart')});g=setTimeout(function(){b.settings.wheels=C(t,null,c);var e=[],i=c,o=H(t,c);b.temp=o.nVector.slice(0);while(i<o.lvl){e.push(i++)}F(a,o.lvl);$('.dwwl'+c,a).unbind('mousedown touchstart');b.changeWheel.apply(null,Array.prototype.slice.call(e,0));b.settings.readonly=false;u=b.temp.slice(0);y(a,o.lvl,q,b.temp)},j*1000)}else{var o=H(t,t.length);y(a,o.lvl,q,t);F(a,o.lvl)}}}}})(jQuery);
